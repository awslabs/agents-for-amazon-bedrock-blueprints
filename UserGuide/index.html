
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Amazon Bedrock Agent Blueprints Construct - Agent Blueprints for Amazon Bedrock</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#amazon-bedrock-agent-blueprints-construct" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Agent Blueprints for Amazon Bedrock" class="md-header__button md-logo" aria-label="Agent Blueprints for Amazon Bedrock" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Agent Blueprints for Amazon Bedrock
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Amazon Bedrock Agent Blueprints Construct
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/awslabs/agents-for-amazon-bedrock-blueprints" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Github: AgentBlueprints
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Agent Blueprints for Amazon Bedrock" class="md-nav__button md-logo" aria-label="Agent Blueprints for Amazon Bedrock" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Agent Blueprints for Amazon Bedrock
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/awslabs/agents-for-amazon-bedrock-blueprints" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Github: AgentBlueprints
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/about-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Agents for Amazon Bedrock
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/learn-cdk/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    [Optional] Learn about AWS CDK
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/prerequisite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prerequisites
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Using Construct to Build Agents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Using Construct to Build Agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-constructs/getting-started-with-constructs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get Started with Constructs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-constructs/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example Template Using Constructs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-constructs/features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customization Options
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-constructs/helper-constructs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Helper Constructs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-constructs/test-deploy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test and Deploy Constructs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Using Templates to Build Agents
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Using Templates to Build Agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-templates/getting-started-with-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Get Started with Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-templates/ag-function-definition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent blueprint for function definition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-templates/ag-roc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent blueprint for return of control
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-templates/ag-kb-guardrails/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent blueprints for RAG, custom Action group, and guardrails
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-templates/ag-advance-prompts-parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent blueprints for advance prompts and lambda parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-templates/ag-classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agent blueprint for classification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prompt-library/prompt-library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompt Library
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../support/support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="amazon-bedrock-agent-blueprints-construct">Amazon Bedrock Agent Blueprints Construct<a class="headerlink" href="#amazon-bedrock-agent-blueprints-construct" title="Permanent link">&para;</a></h1>
<p>The <code>BedrockAgentBlueprintsConstruct</code> is a high-level construct that simplifies the process of creating and configuring Amazon Bedrock agents. It provides a convenient way to define agent properties, action groups, knowledge bases, and guardrails.</p>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h2>
<p>Before you can use the <code>BedrockAgentBlueprintsConstruct</code>, ensure that you have the following:
- An AWS account with the necessary permissions to create and manage Bedrock resources.
- The AWS CDK installed and configured on your local machine.
- Node.js and npm installed.</p>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<ol>
<li>Create a new CDK project or navigate to an existing one.    </li>
<li>Install the <code>BedrockAgentBlueprintsConstruct</code> package:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>npm install @aws/agents-for-amazon-bedrock-blueprints
</code></pre></div>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>Here's an example of how to use the <code>BedrockAgentBlueprintsConstruct</code> in your CDK app:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>import { App, Stack } from &#39;aws-cdk-lib&#39;;
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>import { AgentDefinitionBuilder } from &#39;./constructs/AgentDefinitionBuilder&#39;;
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>import { AgentActionGroup } from &#39;./constructs/AgentActionGroup&#39;;
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>import { BedrockAgentBlueprintsConstruct } from &#39;./BedrockAgentBlueprintsConstruct&#39;;
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>const app = new App();
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>const stack = new Stack(app, &#39;MyStack&#39;);
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>// Define the agent properties
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>const agentDef = new AgentDefinitionBuilder(stack, &#39;NewAgentDef&#39;, {})
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>  .withAgentName(&#39;MyFriendlyAgent&#39;)
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>  .withInstruction(&#39;A helpful agent for coding tasks&#39;)
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>  .build();
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>// Define an action group
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>const action = new AgentActionGroup(stack, &#39;MyAction&#39;, {
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>  actionName: &#39;CodeAction&#39;,
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>  description: &#39;An action for generating code snippets&#39;,
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>  lambdaDefinition: {
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>    // Lambda function definition
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>  },
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>  schemaDefinition: {
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>    // API schema definition
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>  },
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>});
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>// Create the BedrockAgentBlueprintsConstruct
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>new BedrockAgentBlueprintsConstruct(stack, &#39;MyAgentBlueprint&#39;, {
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>  agentDefinition: agentDef,
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>  actionGroups: [action],
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>});
</code></pre></div>
<p>In this example, we first define the agent properties using the <code>AgentDefinitionBuilder</code>. Then, we create an action group with a Lambda function and API schema definition. Finally, we instantiate the <code>BedrockAgentBlueprintsConstruct</code> and pass in the agent definition and action group.
You can further customize the agent by adding knowledge bases, guardrails, and other configurations.</p>
<h2 id="features">Features<a class="headerlink" href="#features" title="Permanent link">&para;</a></h2>
<p>The <code>BedrockAgentBlueprintsConstruct</code> provides several customization options:</p>
<h3 id="opt-out-of-creating-knowledge-base-kb-resources">Opt-out of creating knowledge base (KB) resources<a class="headerlink" href="#opt-out-of-creating-knowledge-base-kb-resources" title="Permanent link">&para;</a></h3>
<p>Users can choose to opt-out of creating KB resources as it can become expensive to deploy the AOSS clusters for KB. If any template initializes KB, you can skip KB creation by adding a flag skipKBCreation in the CDK context.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>cdk synth &lt;STACK_NAME&gt; --context skipKBCreation=true
</code></pre></div></p>
<h3 id="iam-role-management">IAM Role Management<a class="headerlink" href="#iam-role-management" title="Permanent link">&para;</a></h3>
<p>The <code>BedrockAgentBlueprintsConstruct' will automatically create and manage an IAM role for your Bedrock agent if you don't provide one. If you don't specify an</code>agentResourceRoleArn<code>in the</code>AgentDefinitionBuilder`, the construct will create a new IAM role with the necessary permissions for your agent. It will add required permissions for the ActionGroup invocation, FoundationModel access, KB access etc.</p>
<p>However, if you prefer to use an existing IAM role, you can provide the ARN of that role using the <code>withAgentResourceRoleArn()</code> method in the <code>AgentDefinitionBuilder</code>.</p>
<p>This also adds a resource policy to the Lambda functions associated with the provided action groups. The permission allows the 'bedrock.amazonaws.com' service principal to invoke the Lambda function, using the agent's ARN as the source ARN. This ensures that the Bedrock service can invoke the Lambda functions associated with the agent's action groups</p>
<h3 id="asset-bucket-management">Asset bucket management<a class="headerlink" href="#asset-bucket-management" title="Permanent link">&para;</a></h3>
<p>The <code>BedrockAgentBlueprintsConstruct</code> automatically creates and manages Amazon S3 buckets for storing the contents of your knowledge bases and action groups. When you define a knowledge base using the <code>AgentKnowledgeBase</code>construct and add files from local store and/or when you use a file for defining schema for an action group using the <code>AgentActionGroup</code> construct the <code>BedrockAgentBlueprintsConstruct</code> creates an S3 bucket and uploads the specified asset files to it under separate folders. This feature simplifies the management of your agent's assets and ensures that they are securely stored and easily accessible by the corresponding AWS services. </p>
<h2 id="helper-constructs">Helper constructs<a class="headerlink" href="#helper-constructs" title="Permanent link">&para;</a></h2>
<h3 id="agent-definition">Agent Definition<a class="headerlink" href="#agent-definition" title="Permanent link">&para;</a></h3>
<p>The <code>AgentDefinitionBuilder</code>is a utility construct that simplifies the process of creating and configuring Amazon Bedrock agent definitions. It follows the builder pattern and uses composition to generate the <code>CfnAgentProps</code> required for creating a Bedrock agent.</p>
<h4 id="generating-cfnagentprops">Generating CfnAgentProps<a class="headerlink" href="#generating-cfnagentprops" title="Permanent link">&para;</a></h4>
<p>The primary purpose of the <code>AgentDefinitionBuilder</code> is to generate the <code>CfnAgentProps</code> object, which is required for creating a Bedrock agent using the CfnAgent CDK construct. The builder provides a fluent interface for setting various properties of the agent definition, such as the agent name, instruction, foundation model, etc. Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>const agentDef = new AgentDefinitionBuilder(stack, &#39;NewAgentDef&#39;, {})
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>  .withAgentName(&#39;MyAgent&#39;)
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>  .withInstruction(&#39;My agent instructions to build a great agent&#39;)
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>  .withFoundationModel(&#39;anthropic.claude-v2&#39;)
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>  .withAgentResourceRoleArn(&#39;arn:aws:iam::123456789012:role/MyExistingRole&#39;)
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>  .build();
</code></pre></div></p>
<h4 id="prompt-configuration">Prompt Configuration<a class="headerlink" href="#prompt-configuration" title="Permanent link">&para;</a></h4>
<p>The <code>AgentDefinitionBuilder</code> simplifies the creation and configuration of prompts for your Bedrock agent. It provides methods for adding different types of prompts from the prompt library, such as pre-processing, post-processing, and response generation prompts.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>const prompt: bedrock.CfnAgent.PromptConfigurationProperty = {
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>  promptType: PromptType.PRE_PROCESSING,
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  promptCreationMode: PromptConfig_Default,
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>  basePromptTemplate: &#39;This is a test prompt&#39;,
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>};
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>builder.withPreprocessingPrompt(prompt);
</code></pre></div>
The builder also includes validations to ensure that prompt configurations are valid and consistent. For example, it checks if the required fields are provided and prevents redefining the same prompt type.</p>
<h4 id="user-input-action">User Input Action<a class="headerlink" href="#user-input-action" title="Permanent link">&para;</a></h4>
<p>Creating a user input action group is not straightforward when using the AWS CLI or SDK. The <code>AgentDefinitionBuilder</code> simplifies this process by providing the <code>withUserInput()</code> method, which automatically creates and configures the necessary resources for a user input action group.
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>const builder = new AgentDefinitionBuilder(stack, &#39;NewAgentDef&#39;, {});
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>builder.withAgentName(&#39;MyAgent&#39;);
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>builder.withUserInput();
</code></pre></div></p>
<p>This method adds the required action group, using parentActionGroupSignature as <code>AMAZON.UserInput</code></p>
<h3 id="action-groups">Action Groups<a class="headerlink" href="#action-groups" title="Permanent link">&para;</a></h3>
<p>The <code>AgentActionGroup</code> construct is a lightweight utility that allows you to define and configure action groups for your Amazon Bedrock agent. Action groups represent a set of actions that your agent can perform, and they are associated with a Lambda function and an API schema.</p>
<h4 id="properties">Properties<a class="headerlink" href="#properties" title="Permanent link">&para;</a></h4>
<ul>
<li>actionGroupName(required): The name of the action group.</li>
<li>description(optional): A description of the action group.</li>
<li>actionGroupExecutor(required): An object that defines the Lambda function responsible for executing the action group. This allows you to customize the Lambda function that will execute the action group. You can specify the following properties:</li>
<li>lambdaDefinition: An object that defines the Lambda function code, handler, and runtime.<ul>
<li>lambdaCode: The code for the Lambda function (e.g., an inline code buffer or a reference to a file).</li>
<li>lambdaHandler: The handler function for the Lambda function.</li>
<li>lambdaRuntime: The runtime environment for the Lambda function (e.g., nodejs18.x).</li>
</ul>
</li>
<li>lambdaExecutor: Custom lambda function object that can directly be associated with an action.</li>
<li>customControl: Constant string that will be returned to the user as a fixed response.</li>
<li>NOTE: if all multiple params are defined lambdaExecutor will take precedence followed by lambdaDefinition then customControl.</li>
<li>schemaDefinition(required): An object that allows you to define the API/Function schema for the action group. You can specify the schema in one of the following ways:</li>
<li>inlineAPISchema: An inline API schema definition as a string.</li>
<li>apiSchemaFile: A file buffer containing the API schema definition. The BedrockAgentBlueprintsConstruct will make a deployment to S3 and construct the URI params to link to the action.</li>
<li>functionSchema: Defines functions that each define parameters that the agent needs to invoke from the user.</li>
<li>actionGroupState(optional): The state of the action group (ENABLED or DISABLED).</li>
<li>parentActionGroupSignature(optional): Used to define reserved actions.</li>
</ul>
<h4 id="example">Example:<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>const inlineCode = Buffer.from(
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    `
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>        exports.handler = async (event) =&gt; {
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>            return { message: process_stuff() };
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>        };
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    `);
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>const fileBufferSchema: Buffer = readFileSync(resolve(__dirname, &#39;assets&#39;, &#39;openAPISchema.json&#39;));
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>const action1 = new AgentActionGroup(this, &#39;NewAction&#39;, {
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>    actionGroupName: &#39;DummyAction&#39;,
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>    description: &#39;Dummy action for dummy agent&#39;,
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    actionGroupExecutor: {
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>        lambdaDefinition: {
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>            lambdaCode: inlineCode,
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>            lambdaHandler: &#39;index.handler&#39;,
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>            lambdaRuntime: Runtime.NODEJS_18_X
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>        }
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    },
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>    schemaDefinition: {
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>        inlineAPISchema: fileBufferSchema.toString(&#39;utf8&#39;)
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>    },
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>});
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>const lambdaFunction = new Function(this, &#39;MyLambdaFunction&#39;, {
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>      runtime: Runtime.NODEJS_14_X,
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>      code: Code.fromInline(inlineCode.toStrint(&#39;utf8&#39;)),
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>      handler: &#39;index.handler&#39;,
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>    });
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>const action2 = new AgentActionGroup(this, &#39;NewAction&#39;, {
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>    actionGroupName: &#39;DummyAction2&#39;,
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>    description: &#39;Dummy action for dummy agent&#39;,
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>    actionGroupExecutor: {
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>        lambdaExecutor: lambdaFunction,
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>    },
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>    schemaDefinition: {
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>        apiSchemaFile: fileBufferSchema,
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>    },
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>});
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>const action3 = new AgentActionGroup(this, &#39;NewAction&#39;, {
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>    actionGroupName: &#39;DummyAction3&#39;,
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>    description: &#39;Call this action when nothing is available&#39;,
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>    actionGroupExecutor: {
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>        customControl: &#39;Nothing is available&#39;,
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>    }
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>});
<a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>
<a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>new BedrockAgentBlueprintsConstruct(stack, &#39;MyAgentBlueprint&#39;, {
<a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>  agentDefinition: agentDef,
<a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>  actionGroups: [action1, action2, action3],
<a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>});
</code></pre></div>
<h3 id="knowledge-bases">Knowledge Bases<a class="headerlink" href="#knowledge-bases" title="Permanent link">&para;</a></h3>
<p>The <code>AgentKnowledgeBase</code> construct is a utility class that simplifies the creation and management of Amazon Bedrock knowledge bases. A knowledge base is a repository of information that can be used to train and enhance the capabilities of an Agent.
The <code>AgentKnowledgeBase</code> construct allows you to configure various aspects of a knowledge base, such as the storage configuration, knowledge base type, and data sources.
To create a basic knowledge base with default settings, you can use the following code:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>const kbProps = {
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>  kbName: &#39;TestKB&#39;,
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>  agentInstruction: &#39;Test instruction for the Knowledge Base&#39;,
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>  assertFiles: [/* ... */], // Array of file buffers to include in the Knowledge Base
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>};
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>const kb = new AgentKnowledgeBase(stack, &#39;TestKB&#39;, kbProps);
</code></pre></div>
<p>This will create a knowledge base with the name 'TestKB', set default values for the embedding model TITAN_EMBED_TEXT_V1 with AmazonOpenSearchServerless collection, and set default vector index.</p>
<h4 id="customizing-knowledge-base-properties">Customizing Knowledge Base Properties<a class="headerlink" href="#customizing-knowledge-base-properties" title="Permanent link">&para;</a></h4>
<p>You can customize various properties of the knowledge base by passing additional options to the <code>AgentKnowledgeBase</code> constructor:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>const kbProps = {
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>  kbName: &#39;TestKB&#39;,
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>  agentInstruction: &#39;Test instruction for the Knowledge Base&#39;,
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>  assertFiles: [/* ... */],
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>  storageConfiguration: {
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    type: &#39;OPENSEARCH_SERVERLESS&#39;,
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>    configuration: {
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>      indexConfiguration: {...custom index config}
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    },
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>  },
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>  embeddingModel: BedrockKnowledgeBaseModels.TITAN_EMBED_TEXT_V1
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>};
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>const kb = new AgentKnowledgeBase(stack, &#39;TestKB&#39;, kbProps);
</code></pre></div>
<h3 id="iam-role-management_1">IAM Role Management<a class="headerlink" href="#iam-role-management_1" title="Permanent link">&para;</a></h3>
<p><code>AgentKnowledgeBase</code> will create a service role to allow agent to access the KB and allow the KB to access the asset files in S3, permissions for accessing the AOSS collection, and indices and permissions for accessing the embedding models.</p>
<h4 id="creating-and-synchronizing-data-sources">Creating and Synchronizing Data Sources<a class="headerlink" href="#creating-and-synchronizing-data-sources" title="Permanent link">&para;</a></h4>
<p>The <code>AgentKnowledgeBase</code> construct provides a method <code>createAndSyncDataSource</code> to create and synchronize data sources with the knowledge base. Data sources can be Amazon S3 buckets or folders containing the information you want to include in the Knowledge Base.
When we attach a knowledge base to the <code>BedrockAgentBlueprintsConstruct</code> it calls the <code>createAndSyncDataSource</code> to populate the knowledge base with the data in asset management bucket.</p>
<h4 id="opensearchserverlesshelper">OpenSearchServerlessHelper<a class="headerlink" href="#opensearchserverlesshelper" title="Permanent link">&para;</a></h4>
<p>The <code>OpenSearchServerlessHelper</code> construct is a utility class that simplifies the creation and management of Amazon OpenSearch Serverless collections and indices. This construct is used internally by the <code>AgentKnowledgeBase</code> construct when configuring the storage configuration with OpenSearch Serverless.</p>
<p>When you create an <code>AgentKnowledgeBase</code> with the <code>storageConfig.type = 'OPENSEARCH_SERVERLESS'</code>, the <code>OpenSearchServerlessHelper</code> construct is used to create an OpenSearch Serverless collection and the necessary resources (access policies, security policies, and Lambda functions) for managing the collection.</p>
<p>You can also use the <code>OpenSearchServerlessHelper</code> construct directly if you need to create and manage OpenSearch Serverless collections and indices outside of the <code>AgentKnowledgeBase</code> context:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>import { OpenSearchServerlessHelper, CollectionType } from &#39;./constructs/utilities/OpenSearchServerlessHelper&#39;;
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>const helper = new OpenSearchServerlessHelper(stack, &#39;TestHelper&#39;, {
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  collectionName: &#39;test-collection&#39;,
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>  accessRoles: [accessRole],
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>  region: &#39;us-east-1&#39;,
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>  accountId: &#39;123456789012&#39;,
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>  collectionType: CollectionType.VECTORSEARCH, // Specify the collection type
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>});
</code></pre></div>
<h3 id="guardrails">Guardrails<a class="headerlink" href="#guardrails" title="Permanent link">&para;</a></h3>
<p>The <code>BedrockGuardrailsBuilder</code> construct is a utility class that simplifies the creation of Amazon Bedrock Guardrails. Guardrails are a set of rules and policies that help ensure the safety and compliance of your AI applications. The 
<code>BedrockGuardrailsBuilder</code> allows you to configure various aspects of a Guardrail, such as content filtering, sensitive information handling, topic management, and word policies.
After you've built the Guardrail using the <code>BedrockGuardrailsBuilder</code> you can associate it with an Amazon Bedrock Agent Blueprint using the <code>BedrockAgentBlueprintsConstruct</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>const guardrail = guardrailBuilder.build();
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>new BedrockAgentBlueprintsConstruct(stack, &#39;TestConstruct&#39;, {
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>  agentDefinition: agentDefinition,
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>  guardrail: guardrail,
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>});
</code></pre></div>
<p>This will associate the Guardrail with the Agent Blueprint ensuring that the configured policies are applied to the Agent.</p>
<h4 id="customizing-guardrail-properties">Customizing Guardrail Properties<a class="headerlink" href="#customizing-guardrail-properties" title="Permanent link">&para;</a></h4>
<p>You can customize various properties of the Guardrail by passing additional options to the <code>BedrockGuardrailsBuilder</code> constructor:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>const guardrailBuilder = new BedrockGuardrailsBuilder(stack, &#39;TestGuardrail&#39;, {
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>  name: &#39;TestGuardrail&#39;,
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>  blockedInputMessaging: &#39;Custom input message&#39;,
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>  blockedOutputsMessaging: &#39;Custom output message&#39;,
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>  description: &#39;Test guardrail description&#39;,
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>  kmsKeyArn: &#39;kmsKeyArn&#39;, // Existing KMS Key ARN
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>});
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>const guardrail = guardrailBuilder.build();
</code></pre></div>
<h4 id="generating-a-kms-key">Generating a KMS Key<a class="headerlink" href="#generating-a-kms-key" title="Permanent link">&para;</a></h4>
<p>If you want the <code>BedrockGuardrailsBuilder</code> to generate a new KMS key for you, you can set the <code>generateKmsKey</code> to <code>true</code>. Or you can provide your own key with <code>kmsKeyArn</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>const guardrailBuilder = new BedrockGuardrailsBuilder(stack, &#39;TestGuardrail&#39;, {
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>  name: &#39;TestGuardrail&#39;,
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>  generateKmsKey: true,
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>});
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>const guardrail = guardrailBuilder.build();
</code></pre></div>
<h4 id="configuring-content-policies">Configuring Content Policies<a class="headerlink" href="#configuring-content-policies" title="Permanent link">&para;</a></h4>
<p>The <code>BedrockGuardrailsBuilder</code> allows you to configure content policies for filtering, sensitive information handling, topic management, and word policies. Here's an example of how to use these configurations:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>const guardrailBuilder = new BedrockGuardrailsBuilder(stack, &#39;TestGuardrail&#39;, {
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>  name: &#39;TestGuardrail&#39;,
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>  description: &#39;Test guardrail with all configurations&#39;,
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>  generateKmsKey: true,
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>})
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>  .withFiltersConfig(FilterType.VIOLENCE, FilterStrength.HIGH, FilterStrength.MEDIUM)
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>  .withFiltersConfig(FilterType.SEXUAL, FilterStrength.LOW)
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>  .withPIIConfig(PIIAction.BLOCK, PIIType.EMAIL)
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>  .withPIIConfig(PIIAction.ANONYMIZE, PIIType.NAME)
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>  .withTopicConfig(&#39;Politics&#39;, &#39;Discussions related to politics&#39;, [&#39;election&#39;, &#39;government&#39;])
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>  .withManagedWordsConfig(ManagedWordsTypes.PROFANITY)
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>  .withWordsConfig([&#39;badword1&#39;, &#39;badword2&#39;]);
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>const guardrail = guardrailBuilder.build();
</code></pre></div>
<p>This example demonstrates how to configure filters for violence and sexual content, handle sensitive information like emails and names, manage topics related to politics, and block or allow specific words or profanity.</p>
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<p>The <code>BedrockAgentBlueprintsConstruct</code> includes unit tests to ensure the correct behavior of the construct. You can run the tests using the following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>npm test
</code></pre></div>
<h2 id="deployment">Deployment<a class="headerlink" href="#deployment" title="Permanent link">&para;</a></h2>
<p>To deploy your CDK app with the <code>BedrockAgentBlueprintsConstruct</code>, follow the standard CDK deployment process:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>npm run build
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>cdk synth
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>cdk deploy
</code></pre></div>
<p>This will synthesize the CloudFormation template and deploy the resources to your AWS account.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["tabs", "toc.integrate", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>